
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Get Hired!</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/>

    <!-- Custom styles for this template -->
    <link href="css/jumbotron.css" rel="stylesheet">
 
  </head>

  <body>
  	<div class="container">
		<div class="row">
      		<div class="jumbotron">
					<F5>
				<div>
					<h1>Search Labor</h1>
				</div>
      		</div>     
	  	</div>
		<div class="row">
			<div class="col-md-offset-1 form-group">
				<form id="searchform">
          		<input id="searchbox" type="text" class="form-control" placeholder="Search">
        		</form>
			</div>
		<div>
    </div> <!-- /container -->
			<div class="footer">
        		<p>UIUC @ Boilermake 2014</p>
      		</div>

	<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script src="elasticsearch-js/elasticsearch.jquery.min.js"></script>
	<script src="elasticsearch-js/elasticsearch.min.js"></script>
	<script>
		var client = new elasticsearch.Client({
						host: 'localhost:9200',
						log: 'trace'
					});  
	
		$('#searchform').submit(function(ev){
			ev.preventDefault();
			var query = $('#searchbox').val();
			console.log('a');			
			console.log(query);
/**
			var pageNum = request.param('page', 1);
			var perPage = request.param('per_page', 20);
			var userQuery = request.param('search_query');
			var userId = request.session.userId;

			client.search({
				index: 'jobs',
				from: (pageNum - 1) * perPage,
				size: perPage,
				body: {
					filtered: {
						query: {
							match: {
								_all: userQuery
								}
							},
							filter: {
								or: [
								  {
								  	term: {privacy: "public"}
								  },
								  {
								  	term: { owner: userId }
								  }
								]
							}
						}
					}
			}, function(error, response) {
				if(err) {
					console.error("Search Error");
					return;
			}
			response.render('search_results', {
					results: response.hits.hits,
					page: pageNum,
					pages: Math.ceil(response.hits.total / perPage)
				})
			});
		 **/

client.search({
  index: 'jobs',
  type: 'posts',
  body: {
    query: {
      match: {
        _all: query
      }
    }
  }
}).then(function (resp) {
    var hits = resp.hits.hits;
}, function (err) {
    console.trace(err.message);
});
		});				
				
		// Test Function. Pings the server.
		$('#Nada').submit(function(ev){
			ev.preventDefault();
				
			client.ping({
				requestTimeout: 1000,
				hello: "elasticsearch!"
				}, function(error) {
					if(error) {
						console.error('elasticsearch cluster is down sir :(');
					} else {
						console.log('A-OKAY');
					}
			});
		});

	</script>
	</body>
</html>
